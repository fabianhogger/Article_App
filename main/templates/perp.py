import gensim
import gensim.corpora as corpora
import pickle
from gensim import models
from gensim.models.coherencemodel import CoherenceModel
import matplotlib.pyplot as plt
"""
this file is used to get perplexity and umass coherence
"""
"""lda=gensim.models.ldamodel.LdaModel.load('modeltrial3')
corpus=0
texts=0
with open('texts3', 'rb') as f:
    texts = pickle.load(f)
with open('corpustrial3', 'rb') as f:
    corpus = pickle.load(f)
dict = corpora.Dictionary.load('modeltrial3.id2word')
#Calculate model Perplexity ,the lower the better
Perplexity=lda.log_perplexity(corpus)
#Calculate model u_mass Coherence


cm = CoherenceModel(model=lda, texts=texts,dictionary=dict, coherence='c_v')
coherence = cm.get_coherence()  # get coherence value
print(coherence)"""
#-7.958650695324736 -19.14124902634146  0.7035093151019746  3
# -8.252170255890803 -19.779134530506752 0.6994513105015688  7
#-10.116767820974205 -18.960211390940426 0.6306556566719065 12
#-11.272869219263216 -18.96106335991969 12
#-11.272869219263216 -18.96106335991969  0.6196173252687853 13
#-12.748341138981008 -18.391727615412304  0.5603257424259048 14
#-17.9142039288294 -17.91199496748634 0.5489348511009372 16
#-20.47712887634543 -18.14403705903479 0.5894502812140228  17
#-23.122660750513862 -18.012810520712506  0.5782421963275634 18
#-23.915452526958106 -17.94464314352177 0.5670091461873458 19

#-26.00625153568671 ---  0.5728449854365875 21
# -26.430278859780966 0.6014895707432678 22
# -27.100069136746693 0.575478918558578 23
# -28.138468830741846 0.5704623809197508 24
#-29.308551556914665 0.5833582979204361 25
# -30.216550044793802 0.5683274800870232 26
#-30.783869358744813 0.5992864467975528 27
# -31.792982714932542 0.5875805319116826 28
# -32.75803673984227 0.6167791147691182 29
#-34.43128229121187 0.6607036992773081 31
#-37.88745644336227 0.7370768654543094 35
#-42.10432207440238 -19.72100689746852 0.7333481266760191 40

"""
-7.429829774405522 0.7163671490006431 1
-7.711176981130649 0.6634411598364098 2
-7.958650695324736 0.7035093151019746 3
-8.045369173311562 0.7106830048738999 4
-8.128774287869224 0.6949349303961392 5
-8.190371969509481 0.7161707638776093 6
-8.252170255890803 0.6994513105015688 7
-8.306228108057649 0.6848603742192363 8
-8.670710181616947 0.6788641452835575 9
-8.78581448964732 0.6729009827853996 10
-9.409783324926476 0.6611167405056624 11
-10.116767820974205 0.6306556566719065 12
-11.272869219263216 0.6196173252687853 13
-12.748341138981008 0.5603257424259048 14
-15.15685936200509 0.5550504696130434 15
-17.9142039288294 0.5489348511009372 16
-20.47712887634543 0.5894502812140228 17
-23.122660750513862 0.5782421963275634 18
-23.915452526958106 0.5670091461873458 19
-24.22308505078068 0.5567095547575824 20
-26.00625153568671 0.5728449854365875 21
-26.430278859780966 0.6014895707432678 22
-27.100069136746693 0.575478918558578 23
-28.138468830741846 0.5704623809197508 24
-29.308551556914665 0.5833582979204361 25
-30.216550044793802 0.5683274800870232 26
-30.783869358744813 0.5992864467975528 27
-31.792982714932542 0.5875805319116826 28
-32.75803673984227 0.6167791147691182 29
-33.60797514256591 0.6391786276813097 30
-34.43128229121187 0.6607036992773081 31
-35.43118353004559 0.7287705744137518 32
-36.160542544993234 0.737177181664487 33
-37.06468813918505 0.7322173371167235 34
-37.88745644336227 0.7370768654543094 35
-38.489498578249936 0.7344885878174569 36
-39.56263139738309 0.7326599218269975 37
-40.4219160020566 0.736088213112358 38
-41.4312309570114 0.7375029513567731 39
"""
"""
-42.10432207440238 0.7333481266760191 40
-43.26278565218028 0.7357042979790603 41
-44.133549761399145 0.7358721806864891 42
-44.92730641326265 0.7333438559196511 43
-46.09294633258417 0.733945373171247 44
-46.1163049339918 0.7377047913911675 45
-47.529311508683016 0.733840077630097 46
-48.39980261391746 0.7341176513709347 47
-48.89587489436182 0.7358151573592994 48
-50.14901652563283 0.7374619314525668 49
-50.99120847882766 0.735470875582144 50
"""

"""
-7.966315007770107,0.2656988440392789,1
-7.920358863949899,0.2954212858376113,2
-7.911608387029965,0.33924820509992043,3
-7.902707168974823,0.36141643255120215,4
-7.921268723764283,0.35203556897877125,5
-7.937395844125136,0.42926607321377724,6
-7.98751470280052,0.4224577768293224,7
-8.040999973614818,0.3891789259323484,8
-8.162512961969771,0.4323332641677611,9
-8.337085772733122,0.40122133226066914,10
-8.687277526899578,0.35914491557318395,11
-9.200652476435222,0.41457646223375527,12
-9.873490057774857,0.4448994894103771,13
-10.63823057864596,0.46161212905439847,14
-11.174313309466381,0.47971862247276514,15
-11.532137994688956,0.4683256008962384,16
-11.961793950235705,0.444336444021492,17
-12.199894149597476,0.45124943432837156,18
-12.438362778280272,0.4235394197581327,19
-12.674941813616707,0.46729745462038685,20
-12.898204167618363,0.4395344341016569,21
-13.125896046475187,0.4494049905342383,22
-13.383989579393317,0.41499576535795674,23
-13.608425180814129,0.41748822202418556,24
-13.83945397803501,0.4499116436708059,25
-14.089193080964442,0.4151045428457107,26
-14.32642091644036,0.4349526597108247,27
-14.576409914305552,0.4365588710737643,28
-14.776343309760803,0.417505937485084,29
-15.047298770988638,0.4017884246774639,30
-15.267650222995792,0.44699738176675125,31
-15.5039524839588,0.4076781869778984,32
-15.740890349778107,0.41209430114139456,33
-15.959948995982957,0.40698128443605325,34
-16.18347535908454,0.40395660443495807,35
-16.47344043781749,0.41036675713358467,36
-16.686226312243125,0.3907349735116139,37
-16.958274245511074,0.3960627986225753,38
-17.148692702943425,0.4063154312013047,39
-17.38789998066153,0.4182356932727867,40
-17.639253107118527,0.4184948589173859,41
-17.867586298803978,0.40462247541998037,42
-18.123731579539587,0.4216994445884997,43
-18.36047234643151,0.40607656079935966,44
-18.58834865341067,0.3966625110850919,45
-18.817103122566735,0.4017880780312058,46
-19.07481328617909,0.3946353759054421,47
-19.312226295380047,0.400735574476825,48
-19.55676645647862,0.4049673637373835,49
-19.784360399060816,0.42054482335609356,50
"""
#COHERENCE FOR ARTICLE NAMES
t=[0.7163671490006431,0.6634411598364098,0.7035093151019746, 0.7106830048738999,0.6949349303961392,
0.7161707638776093,0.6994513105015688,0.6848603742192363,0.6788641452835575, 0.6729009827853996,
0.6611167405056624,0.6306556566719065,0.6196173252687853,0.5603257424259048, 0.5550504696130434 ,
 0.5489348511009372, 0.5894502812140228,0.5782421963275634,0.5670091461873458,0.5567095547575824,
 0.5728449854365875, 0.6014895707432678,0.575478918558578,0.5704623809197508, 0.5833582979204361,
 0.5683274800870232,0.5992864467975528, 0.5875805319116826,0.6167791147691182,0.6391786276813097,
  0.6607036992773081,0.7287705744137518, 0.737177181664487,0.7322173371167235,0.7370768654543094,
   0.7344885878174569,0.7326599218269975,0.736088213112358,0.7375029513567731, 0.7333481266760191,
   0.7357042979790603, 0.7358721806864891,0.7333438559196511,0.733945373171247,0.7377047913911675,
   0.733840077630097,0.7341176513709347,0.7358151573592994,0.7374619314525668,0.735470875582144]
#PERPLEXITY FOR ARTICLE NAMES
p=[-7.429829774405522 ,-7.711176981130649 ,-7.958650695324736 ,-8.045369173311562 ,-8.128774287869224 ,
-8.190371969509481 ,-8.252170255890803 ,-8.306228108057649 ,-8.670710181616947 ,
-8.78581448964732 ,-9.409783324926476 ,-10.116767820974205 ,-11.272869219263216 ,
-12.748341138981008 ,-15.15685936200509 ,-17.9142039288294 ,-20.47712887634543 ,
-23.122660750513862 ,-23.915452526958106 ,-24.22308505078068 ,-26.00625153568671 ,
-26.430278859780966,-27.100069136746693,-28.138468830741846,-29.308551556914665,
-30.216550044793802,-30.783869358744813,-31.792982714932542,-32.75803673984227,
-33.60797514256591,-34.43128229121187,-35.43118353004559,-36.160542544993234,
-37.06468813918505,-37.88745644336227,-38.489498578249936,-39.56263139738309,
-40.4219160020566, -41.4312309570114,]

#PERPLEXITY FOR ARTICLE BODIES
p2=[-7.966315007770107,-7.920358863949899,-7.911608387029965,-7.902707168974823,-7.921268723764283,
-7.937395844125136,-7.98751470280052,-8.040999973614818,-8.162512961969771,-8.337085772733122,
-8.687277526899578,-9.200652476435222,-9.873490057774857,-10.63823057864596,-11.174313309466381,
-11.532137994688956,-11.961793950235705,-12.199894149597476,-12.438362778280272,-12.674941813616707,
-12.898204167618363,-13.125896046475187,-13.383989579393317,-13.608425180814129,-13.83945397803501,
-14.089193080964442,-14.32642091644036,-14.576409914305552,
-14.776343309760803,-15.047298770988638,-15.267650222995792,-15.5039524839588,-15.740890349778107,-15.959948995982957,
-16.18347535908454,-16.47344043781749,-16.686226312243125,-16.958274245511074,-17.148692702943425,-17.38789998066153,-17.639253107118527,-17.867586298803978,-18.123731579539587,-18.36047234643151,-18.58834865341067,-18.817103122566735,-19.07481328617909,-19.312226295380047,-19.55676645647862,
-19.784360399060816]
#COHERENCE FOR ARTICLE BODIES
t2=[0.2656988440392789,0.2954212858376113,0.33924820509992043,0.36141643255120215,0.35203556897877125
,0.42926607321377724,0.4224577768293224,0.3891789259323484,0.4323332641677611,0.40122133226066914,
0.35914491557318395,0.4448994894103771,0.4448994894103771,0.46161212905439847,0.47971862247276514,
0.4683256008962384,0.444336444021492,0.45124943432837156,0.4235394197581327,0.46729745462038685,
0.4395344341016569,0.4494049905342383,0.41499576535795674,0.41748822202418556,0.4499116436708059,
0.4151045428457107,0.4349526597108247,0.4365588710737643,0.417505937485084,0.4017884246774639,
0.44699738176675125,0.4076781869778984,0.41209430114139456,0.40698128443605325,0.40395660443495807,
0.41036675713358467,0.3907349735116139,0.3960627986225753,0.4063154312013047,0.4182356932727867,
0.4184948589173859,0.40462247541998037,0.4216994445884997,0.40607656079935966,0.3966625110850919,
0.4017880780312058,0.3946353759054421,0.400735574476825,0.4049673637373835,0.42054482335609356]



s=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50]
fig, ax = plt.subplots()
ax.plot(s,t,p)

ax.set(xlabel='Number of topics', ylabel='C-V Coherence',
       title='LDA with default hyperparameter values')
ax.grid()

fig.savefig("test.png")
plt.show()
